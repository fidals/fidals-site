# Магазин элементов питания
**Проект** - [shopelectro.ru](https://www.shopelectro.ru)
<br><br>

- [Сроки](#period)
- [Бизнесу](#4business)
- [Результаты](#results)
- [Командам, прогерам](#4teams)
  - [Технологии](#technologies)
    - [Почему Symfony](#why-symfony)
  - [Как устроен фронт](#front)
  - [Фичи](#features)
    - [Импорт каталога из 1C](#1c-import)
    - [Автотесты](#autotests)
    - [Прайс Excel](#excel)
    - [Автокомплит](#autocomplete)

<br>
<h2 id="period">Сроки</h2>

- Базовый функционал магазина реализовали за 3 мес.
- 6 нед - разработка ТЗ
- 6 нед - разработка сайта

<br>
<h2 id="4business">Бизнесу</h2>

Порядок работы:
- Аналитика + Юзабилити
- Дизайн-макет
- Вёрстка
- Разработка
- Наполнение
- Маркетинг

<br>
<h2 id="results">Результаты</h2>

- Данные собирали с помощью Яндекс.Метрики и 1С.
- в 5 раз увеличилось кол-во заказов
- в 4 раза увеличилась прибыль
- на 45% увеличилась посещаемость

<br>
<h2 id="4teams">Командам, прогерам</h2>

<h3 id="technologies">Технологии</h3>
- Symfony 2.8
- Mysql via Doctrine ORM
- Less + AsseticBundle
- Behat + Selenium
- js + jQuery

<br>
<h3 id="why-symfony">Почему Symfony</h3>
CMS - Стандартные решения для магазинов: Bitrix, OpenCart, ModX и тд
Мы используем Symfony. У него большое сообщество, много готовых компонентов, отностильно легко изучается.

Symfony - фреймворк, не CMS. Мы пишем много вещей руками.


Плюсы и минусы **фреймворка в сравнении с CMS**

Плюсы:
- Каждая библиотека (бандл) подключена осознанно
- высокая скорость работы
- понимаем 100% своего кода
- быстро решаем нетиповые задачи
- быстро обновляемся
- быстро фиксим баги
- наш уровень растёт при выполнении крупных задач

Минусы:
- Типовые задачи решаем медленно


В нашем случае плюсы перевесили минусы, поэтому мы используем Symfony.

<br>
<h3 id="front">Как устроен фронт</h3>
#### MVC style
Самостоятельно сделали структуру фронта, похожую на MVC
```
/js
	/common - сквозной код
	/libs
	/pages - view+controller для каждой страницы сайта
	/services - коннекторы к нашему бэку и сторонним сервисам
/less
	/common - сквозные стили и миксины
	/libs
	/pages - стиль каждой страницы
```

На каждой странице загружаем только нужный js-код и стили с помощью Assetic.
Либы всегда собираем в отдельный файл lib.js / lib.css для кэширования в браузере.

Весь js-код организовали через псевдоклассы. Инкапсуляцию - через паттерн Модуль

<br>
<h3 id="features">Фичи</h3>
<br>
<h4 id="1c-import">Импорт каталога 1C -> Сайт<h4>
![Импорт каталога из 1С](/images/blog/se-project/import-price.jpg "Импорт каталога из 1С")
<br>

Актуальная база товаров находится в 1С. База товаров на сайте является её копией.

Алгоритм работы:
- 1С генерирует файл xml по своей базе
- Скачиваем xml-файл с базой товаров на сервер с сайтом
- Через веб-интерфейс или команду вызываем импорт каталога
- Импорт переносит содержимое xml в mysql-базу сайта
- Сохраняет структуры данных из xml для категорий и товаров

<br>
<h4 id="autotests">Автотесты</h4>
Работаем через TDD. Тестируем данные на фронте.
Автотесты реализовали с помощью Behat+Mink+Selenium

<br>
<h4 id="excel">Прайс Excel</h4>
<a href="/images/blog/se-project/price-excel.jpg" target="_blank">Изображение прайса</a>

Алгоритм:
Берём подготовленный шаблон файла excel
Наполняем его данными по алгоритму

<br>
<h4 id="market">Интеграция с Яндекс.Маркет</h4>
-------
![Интеграция с Яндекс.Маркет](/images/blog/se-project/market.jpg "Интеграция с Яндекс.Маркет")
<br>

YML - [Yandex Market Language](https://yandex.ru/support/partnermarket/yml/about-yml.xml). На нём реализован не только Я.Маркет, но и нес-ко других аггрегаторов товаров.

Мы подключаемся к Яндекс.Маркет и Price.ru

<br>
<h4 id="autocomplete">Автокомплит</h4>
Сортируем результаты выдачи по точности вхождения запроса.
Реализовали на [DQL](http://symfony.com/doc/current/book/doctrine.html#querying-for-objects-with-dql).
